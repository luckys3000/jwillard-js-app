/* eslint-disable no-unused-vars */
/* eslint-disable no-console */
/* eslint-disable no-undef */
let pokemonRepository = (function () {
  let e = [],
    t = 'https://pokeapi.co/api/v2/pokemon/?limit=12';
  function n(e) {
    return e.charAt(0).toUpperCase() + e.slice(1);
  }
  function o() {
    return e;
  }
  function i(t) {
    'object' == typeof t && 'name' in t
      ? ((t.name = n(t.name)), e.push(t))
      : console.log('Error: Pokemon is not correct');
  }
  function r() {
    return fetch(t)
      .then(function (e) {
        return e.json();
      })
      .then(function (e) {
        (t = e.next),
          e.results.map(function (e) {
            i({ name: e.name, detailsUrl: e.url });
          });
      })
      .catch(function (e) {
        console.error(e);
      });
  }
  function a(e) {
    return fetch(e.detailsUrl)
      .then(function (e) {
        return e.json();
      })
      .then(function (t) {
        (e.imageUrl = t.sprites.other.home.front_default),
          (e.height = t.height),
          (e.types = t.types.map((e) => e.type.name)),
          (e.id = t.id);
      })
      .catch(function (e) {
        console.error(e);
      });
  }
  function l(e) {
    a(e).then(() => {
      let t = document.createElement('div');
      t.classList.add('col-12', 'col-sm-6', 'col-md-4', 'col-lg-3', 'mb-4');
      let o = document.createElement('li');
      o.classList.add('list-group-item', 'p-0', 'text-center');
      let i = document.createElement('button');
      i.classList.add('btn', 'btn-primary', 'btn-block'),
        i.setAttribute('data-toggle', 'modal'),
        i.setAttribute('data-target', '#pokemonModal');
      let r = document.createElement('img');
      (r.src = e.imageUrl),
        (r.alt = e.name),
        r.classList.add('img-fluid', 'mb-2');
      let l = document.createElement('span');
      (l.innerText = e.name),
        (function e(t, o) {
          t.addEventListener('click', () => {
            (function e(t) {
              a(t).then(function () {
                var e, o;
                let i, r, a, l, c, m, s, d;
                (e = t),
                  (i = document.querySelector('#pokemonModalLabel')),
                  (r = document.querySelector('#pokemon-image')),
                  (a = document.querySelector('#pokemon-name')),
                  (l = document.querySelector('#pokemon-id')),
                  (c = document.querySelector('#pokemon-height')),
                  (m = document.querySelector('#pokemon-types')),
                  (i.innerText = e.name),
                  (r.src = e.imageUrl),
                  (a.innerText = e.name),
                  (l.innerText = 'National Pokedex Number: ' + e.id),
                  (c.innerText = `Height: ${(d = Math.floor((s = 3.937 * (o = e.height)) / 12))} ft ${(s = Math.round(s % 12))} in`),
                  (m.innerText = 'Types: ' + e.types.map(n).join(', '));
              });
            })(o);
          });
        })(i, e),
        i.appendChild(l),
        i.appendChild(r),
        o.appendChild(i),
        t.appendChild(o);
      document.querySelector('.pokemon-list').appendChild(t);
    });
  }
  return (
    document.querySelector('#load-more').addEventListener('click', async () => {
      await r(), e.slice(-12).forEach((e) => l(e));
    }),
    { add: i, getAll: o, addListItem: l, loadList: r, loadDetails: a }
  );
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (e) {
    pokemonRepository.addListItem(e);
  });
});
